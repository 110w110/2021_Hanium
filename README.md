## 2021 한이음 프로젝트 공모전  
스마트 안경을 이용한 똑쇼 (똑똑한 쇼핑) / 임의의팀  
  
### 프로젝트 개요
- 팀명 : 임의의팀
- 팀장 : 한태희
- 팀원 : 한태희 전수민 김지석 김민석
- 멘토 : 한주연 멘토님

## 2020 한이음 프로젝트 공모전  
스마트 안경을 이용한 똑쇼 (똑똑한 쇼핑) / 임의의팀  
(Smart Shopping Using Smart Glasses : Ttokshow)   
  
## 프로젝트 정보
#### 작품 정보
- 작품명 : Ttokshow (똑쇼)
- 프로젝트 기간 : 2021.3 ~ 2021.11
- 팀원 : 한태희(팀장), 김민석, 김지석, 전수민
- 멘토 : 한주연 멘토님 (KISA)

#### 작품 설명 : 
본 프로젝트의 스마트 안경은 부착된 카메라를 통해 쇼핑 중에 상품의 정보를 읽고, 인터넷상의 리뷰들을 빠르게 수집하여 사용자에게 알려준다. 사용자가 마트에서 상품을 선택할 때, 해당 상품의 리뷰를 인터넷에 직접 검색하지 않아도 손쉽게 이어폰으로 확인할 수 있어 더욱 편리하고 합리적인 쇼핑을 할 수 있게 된다. 
마트에 진열된 수많은 상품들을 보고 어떤 상품을 골라야 하는지 고민해 본 사람들은 알 것이다. 이제 스마트 안경을 통해 손쉽게 나에게 딱 맞는 상품을 선택함으로서 똑똑한 쇼핑을 해보자

#### [공모전 출품 영상 Link](https://youtu.be/Pcsiy823xeI)
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181168044-de8193a1-78af-4400-a223-bdaeb2c091d9.png">
</div>

## 작품 소개
### 1. 기획 의도
   - 리뷰를 찾아보기 위해서는 검색해야하는 번거로움이 따름 
   - 단계를 줄여줌으로써 편리성이 증가함
   - 결과적으로 소비자에게 맞는 상품을 손쉽게 찾게 해줘서 구매를 유도시킴
   
### 2. 작품 내용
   - ESP-32 CAM 아두이노 보드를 통한 영상 스트리밍 
   - WiFi 통신 및 포트포워딩을 통한 외부 접속 허용 
   - 스트리밍되는 영상에서 바코드 번호 추출 및 DB 내 상품 조회 
   - 상품 리뷰 크롤링 및 수집된 리뷰 분석하여 텍스트마이닝하여 DB에 저장 
   - 똑쇼 앱에서 상품을 조회하면 DB 내의 정보를 요약해주고 TTS를 활용하여 
   - 음성 출력 지원

## 작품의 개발배경 및 필요성

스마트워치, 무선이어폰 등 여러 가지 분야의 웨어러블 기기들이 상용화에 성공했지만 여전히 스마트 안경 분야는 개발이 부족한 상황이다. 
이미 수년 전 구글을 통해 '구글글래스'가 출시되었을 때 스마트 안경 시대가 금방 도래할 분위기였으나, 사생활 침해의 문제 등 여러 장벽에 부딪혀 발전이 늦춰진 상황이다.
이러한 스마트 안경을 우리 생활과 밀접한 분야인 쇼핑에 접목을 시키면 어떨까? 스마트 안경을 쇼핑에 접목 시켜 마트 내에서의 사용으로 제한한다면 사생활 침해 문제로부터는 자유로울 수 있다. 
우리는 쇼핑을 할 때 모든 구매품목에 대한 정보를 정확히 알고 구매하지는 않는다. 그저 눈에 쉽게 보이는 한정된 정보로 판단하며, 가끔은 직감에 따라 구매했다가 후회하는 경우도 적지 않다. 

<div align="center">
<img width="240" alt="image" src="https://user-images.githubusercontent.com/87888411/181168727-58ccf016-80f6-4a07-a2d2-5e0b2560e9a1.png">
</div>

특히 고령층으로 갈수록 인터넷에서 정보를 찾는데 어려움이 증가한다. 위 표에 따르면 소비자정보 접근성이 일반인은 7점 만점에 평균 5.9점인 반면 나이가 증가할수록 점수가 점점 떨어져 초고령노인은 평균 1.8점으로 나타나게 된다. 이를 해결하기 위해 스마트 안경을 통해 정보 수집 단계를 줄여 손쉽게 소비자 정보에 접근이 가능해져 쇼핑의 질을 높일 수 있다. 
쇼핑을 위해 준비된 스마트 안경이 다양한 상품들의 후기나 정보 등을 인터넷 상에서 찾아와 보기 좋게 정리해준다면 더욱 알차고 합리적인 쇼핑을 할 수 있을 것이다. 
또한 검색의 간소화로 짧은 시간에 다양한 상품 검색이 가능해져 더욱 빠르고 편리한 쇼핑이 가능할 것이다. 
본 프로젝트에서는 이런 아이디어에서 착안하어 바코드가 존재하는 상품들을 안경의 카메라 모듈을 통해 인식하고 데이터를 분석하여 정리해주는 프로토타입과 그와 연동된 모바일 앱을 만들어 내는 것이 주요 목적이다.

## 작품의 특징 및 장점 

1) 바코드 번호를 통해 상품을 검색하여 상품 정보를 보여주는 것은 많다. 하지만  실 사용자의 리뷰 정보를 종합적으로 분석하여 보여주는 것을 통해 사용자들의 합리적인 쇼핑에 많은 도움을 줄 것이다.
2) 스마트안경에서 발생하는 사생활 침해 이슈를 ‘똑쇼’는 사용 장소를 마트 내로제한하여 기존 개인용 스마트안경에서 발생하는 문제를 해결할 수 있다. 
3) 실제 스마트안경 시장이 발전이 더딘 상황에서 ‘똑쇼’가 좋은 예시가 되어 스마트안경 시장 발전에 이바지할 수 있다.
4) 스마트폰을 이용하여 리뷰를 확인할 수 있지만 검색을 하지 않고 스마트안경을 착용하여 원하는 상품의 바코드를 바라보기만 하여도 해당 상품의 정보, 평점, 리뷰 등을 확인할 수 있다. 이로써 편리성을 증대시키고 나아가 상품 비교 및 관리에 있어서 효율성 또한 증대시킬 수 있다.
5) 대부분의 상품에 대한 정보를 인터넷 상에서 검색할 수 있지만 ‘똑쇼’는 실시간으로 반영되는 새로운 리뷰들과 그 정보를 도식화한 자료를 한눈에 볼 수 있어 정보이용 취약계층 또한 손쉽게 사용할 수 있을 것이다.

## 작품 내용

### 1. 서비스 구성도
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181174491-ae2ab315-f915-41ba-838a-6ec4129e9bf4.png">
</div>

### 2. 하드웨어 구성도
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181174621-c2ce14b8-f0ed-4d79-baea-174b27432cf2.png">
</div>

### 3. 센서 구성도
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181169507-85baa52e-6d4b-4626-badb-ae4de87fc3bb.png">
</div>

### 4. 알고리즘 명세서
<div align="center">
<img width="280" alt="image" src="https://user-images.githubusercontent.com/87888411/181174842-12aeb3b8-e069-431e-a2cc-700851047e0f.png">
</div>

### 5. 메뉴 구성도
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181174795-1a72b46e-1b30-4786-adbc-e8ce2e583af0.png">
</div>

### 6. 기능 처리도
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181174911-e5a58c4d-c472-4a1a-8b3c-fe72fdb91666.png">
</div>

### 7. E-R 다이어그램
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181174686-c0040558-ce51-42fa-aae7-8598d591b396.png">
</div>

### 8. 테이블 정의서
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181175047-27713a7c-c181-442c-9720-942f6c6c4066.png">
</div>

### 9. UI/UX 정의서
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181175419-1d1836ad-4673-4988-8d9c-a54979dc9b73.png">
</div>
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181175506-d0b15144-2027-4fa2-b5fa-69c8becc08a0.png">
</div>

## 작품 기능
#### 전체 기능 목록 
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181175749-968c8b54-c621-4336-9656-1a89108ba99e.png">
</div>

#### SW 주요 기능
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181175827-8513c04d-ff36-46d0-a58a-94fd432d7c6e.png">
</div>
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181175893-1efe64c4-5c8e-473c-bf5d-0bd819a0cc6a.png">
</div>
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181175980-cb7a158e-ab53-4478-b474-8bedaedc607a.png">
</div>

#### HW 주요 기능
<div align="center">
<img width="450" alt="image" src="https://user-images.githubusercontent.com/87888411/181176086-fb665b9d-0137-48f8-9200-e5537c6b374f.png">
</div>

### 3. 주요 적용 기술
#### 1) H/W
##### ESP-32 CAM & WiFi Manager
ESP-32 CAM는 똑쇼의 메인보드로 사용된 아두이노 보드이다. 해당 보드는 기본적으로 카메라, WiFi 모듈, 블루투스 모듈을 탑재하고 있다. 이 보드는 바코드를 촬영하고 WiFi 통신을 통해 전달하는 과정을 담당하기에 충분한 성능이라고 판단되었고, 실제로 상용화를 진행하게 되어도 저렴한 가격으로 대량생산에 용이하다는 장점이 있다. 

이 보드에 업로드한 WiFi Manager는 스마트폰을 이용해 특정 네트워크에 연결할 수 있도록 설계해두었다. 매번 아두이노를 재부팅할 때마다 수동으로 연결하도록 해두었으나, 특정 네트워크가 어떤 네트워크로 연결될 지 정해져있다면 해당 네트워크에 자동으로 연결할 수 있도록 변경할 수 있다.

#### 2) S/W
##### zbar & zxing
바코드는 ESP-32 카메라를 통해 인식하거나, 스마트폰 카메라를 통해 인식할 수 있다. ESP-32 카메라를 활용하면 로컬 네트워크를 통해 실시간으로 영상을 전송하게 되고, OpenCV와 zbar 라이브러리를 사용하여 서버에서 바코드를 빠르게 스캔해낸다. 관리자가 내부망이 아닌 외부에서도 접속할 수 있도록 네트워크 포트포워딩을 활용해서 연결할 수 있도록 설계해두었다. 

스마트폰 카메라를 활용할 경우에는 어떤 바코드가 인식되는 지에 따라서 스마트안경 매칭 또는 상품 검색으로 나뉜다. 스마트안경에 미리 할당해 둔 QR코드를 인식하게 되면 해당 안경과 스마트폰 APP이 매칭이 되고, 바코드가 인식된다면 해당 상품을 바로 검색하여 상품 정보를 출력한다. 
또한 스마트폰 카메라로 바코드를 찍게 되면 안드로이드의 zxing을 활용하여 처리하게 된다. 이 경우는 서버와 응답할 필요가 없으므로 더욱 빠른 응답속도를 나타낸다.

##### MySQL & AWS DB
바코드로 상품을 검색했을 때 상품 정보와 리뷰들을 보여주기 위하여 이러한 정보들을 저장해줄 데이터베이스가 필요했다. 따라서 AWS에서 제공하는 데이터베이스를 생성하여 이를 MySql에 연결시켰고, 파이썬에서 데이터베이스를 관리하기 위해 pymysql을 사용하였다. 상품정보를 데이터베이스에 저장하기 위해 대한상공회의소에서 제공하는 바코드정보 파일을 openpyxl로 엑셀에 접근하여 해당 정보들을 데이터베이스에 저장해 주었다.

##### Firebase
Firebase는 구글이 소유하고 있는 모바일 애플리케이션 개발 플랫폼으로 앱을 개발하고, 개선하고, 키워갈 수 있는 도구 모음(toolset)이다. 안경으로 상품을 인식했을 때 푸시알림을 통해 상품이 검색되었다는 것을 알려주기 위해 Firebase Cloud Messaging(FCM)기능을 사용했다. 특정 기기에만 푸시알림을 주기 위해 Firebase에서 할당해주는 기기 고유의 토큰 값을 서버에 전송하여 해당 기기에만 푸시알림을 줄 수 있도록 한다. 서버에서 FCM을 사용하기 위해 pyfcm을 사용하였다.

##### TTS 
컴퓨터 텍스트를 음성으로 디지털화 한 오디오 렌더링으로 자바의 ‘android.speech.tts.TextToSpeech’라는 패키지를 사용한다. 정보를 다양한 방식으로 전달하기 위해 음성출력을 사용했다. 언어는 한국어로 사용하고, 음량과 재생속도, 높낮이를 적절하게 설정하여 speak() 메소드를 통해 다양한 정보를 음성으로 출력한다. 상품이름 및 평점 그리고 리뷰에 자주 나온 단어 등을 음성으로 출력해준다.

##### Crawling
웹 페이지를 접근하여 원하는 데이터를 추출해내는 기술이며 동적으로 웹페이지를 접근하여 상품을 검색한 후 추출하기 위해 파이썬의 Selenium 라이브러리를 사용했다. Selenium의 Webdriver를 통해 Chromedriver를 제어하여 SSG과 LotteOn 온라인 쇼핑몰의 상품 정보와 리뷰 데이터를 추출해온다. 

상품의 모든 리뷰들을 추출하기 위해서 마지막 페이지까지 순차적으로 탐색하도록 수정하였고, 조회되지 않거나 리뷰가 없는 상품은 수집하지 않도록 예외처리 하였다. 추출한 데이터를 튜플 형식으로 정리하여 2차원 리스트에 저장하였으며 이를 데이터베이스에 저장하였다.

##### AWS Server
AWS 서버 EC2를 이용하여 클라이언트에서 처리 할 수 없거나 처리 하지 않아도 되는 정보들을 서버에서 처리하게 했다. 이를 통해 어플리케이션에서는 중요한 기능만 돌아가게 하여 경량화했다.

AWS 서버에서 Server.py 파일을 구동하여 socket과 threading 라이브러리를 통해 어플리케이션의 Client.java 파일과 통신하는 알고리즘을 작성하였다.

Client와 통신을 성공하면 어플리케이션 정보 및 휴대폰 정보를 받아오며 스마트 안경과 매칭 시켜 데이터를 저장한다. 이를 통해 여러 개의 스마트안경이 동시에 바코드를 찍어도 데이터 혼선 없이 올바른 휴대폰에 데이터를 전송할 수 있다.

스마트 안경으로 바코드를 인식한 경우, pyfcm 라이브러리의 FCMNotification을 통해 Client로부터 수신한 휴대폰 정보를 이용하여 푸시알림을 전송한다. 이로써 어플리케이션이 꺼져 있는 상태에서도 리뷰 데이터에 접근을 빠르게 할 수 있게 하였다. 또한 ESP-32에서 스트리밍한 영상에 접근하여 바코드를 인식하는 알고리즘을 작성하였으며, 인식 후 AWS Database에 접근하여 원하는 정보만을 받아와 Client 파일에 전송하였다.
 
##### Glide
Glide는 안드로이드 라이브러리로 별도의 처리를 하지 않아 빠르게 이미지를 앱 내에서 로드할 수 있게 해준다. Firebase Database에 올려둔 사진의 링크를 load 명령어로 이미지화하며 into 명령어로 원하는 위치의 View에 보여준다. 

##### 텍스트마이닝
웹쇼핑몰에서 수집한 리뷰들을 텍스트마이닝 기법을 사용하여 핵심 키워드를 추출한다. 이 과정에는 KoNLPy의 Okt 모듈을 통해 문자열을 분석하였으며, Wordcloud 모듈로 키워드를 도식화한 형태로 저장하였다. 

Okt는 KoNLPy의 모듈 중 문자열 처리가 굉장히 빠른 편에 속하지만 리뷰 수가 너무 많이 쌓이면 처리시간이 많이 느려진다. 따라서 수집한 리뷰들 중 상당한 시간이 지나버린 리뷰는 최신 리뷰보다 중요도가 상대적으로 낮다고 판단하여 최신 리뷰부터 정해진 양 만큼의 문자열을 잘라서 처리하도록 설계하였다.


## 작품 사진

### 1. [Python/C++] Darknet: YOLO Mark
<div align="center">
<img width="777" alt="image" src="https://user-images.githubusercontent.com/87888411/181165408-d0d26d96-7e73-4248-894e-0781c33eeb7d.png">

<산불과 사람의 이미지를 인식하도록 라벨링>
</div>


<div align="center">
<img width="417" alt="image" src="https://user-images.githubusercontent.com/87888411/181165685-9e406311-943b-4b96-82e2-3bd5e2a87607.png">
<img width="401" alt="image" src="https://user-images.githubusercontent.com/87888411/181165722-bd1b40f9-6cfc-4e1e-ab2c-ddf431ca96dc.png">

<라벨링된 이미지를 Darknet을 활용하여 이미지를 학습>
</div>

## 작품 개발 환경
<div align="center">
<img width="751" alt="image" src="https://user-images.githubusercontent.com/87888411/181163789-0892f51c-1a7b-4336-8107-28e471594776.png">
</div>

##  작품의 기대효과 및 활용분야 

### 1. 작품의 기대효과
#### 1) **개인적 측면**: 
조난 상황 발생 시, 빠르고 정확하게 조치 받을 수 있을 것으로 기대된다. 또한 사람이 직접 발로 뛰며 상황을 분석할 필요 없이, Drone 조작만으로 산불을 예방하고 조난자를 구출할 수 있을 것이다. 
#### 2) **사회적 측면**: 
잠재적인 산불 상황 예방 또는 조난자 수색에 강력한 수사 도구로써 기능할 것으로 기대된다. 인력의 한계를 보완하고 시간 절약 및 경제적 비용 절감할 수 있을 것이다. 
#### 3) **개발 측면**: 
4차 산업의 핵심으로 조명 받는 Drone과 AI를 접목하여 산업의 발전을 이룰 수 있다. Drone과 AI의 사회적, 국가적 기능을 증명할 수 있는 기회가 될 것으로 기대된다. 
#### 4) **비즈니스적 측면**: 
특정 기업이 Drone을 활용해 공공의 이익에 힘쓰고 있다는 좋은 이미지를 활용해 자연스럽게 브랜드 이미지를 도움을 줄 것이다. 더 나아가 사람들의 자발적인 도네이션을 받기도 하고, 스폰계약을 받아 스폰서 광고를 통한 재정적 이익을 발생시킬 수 있을 것으로 기대된다. 
#### 5) **군사안보적 측면**: 
AI Drone을 군사용으로 응용한다면, 감시가 소홀한 울타리 외 철책 주변 산악지형을 반복적으로 탐사하면서 더욱 면밀한 감시체계를 구축할 수 있을 것이다.

### 2. 작품의 활용분야
- YOLO 알고리즘을 활용한 조난자 수색을 통해 AI Drone의 사회적 활용
- 소방청과 협력하여 AI Drone을 활용한 산악지형의 잠재적 산불의 예방에 활용
- 부가적으로 Drone의 시각적 효과를 이용해 브랜드 가치를 만들고, 사회적 기업활동이나 인접 사업에 대한 홍보까지 발전 가능
- Drone이 목표물을 인식하고 스스로 분석할 수 있게 된다면 조난자 수색 및 산불 감지 목적으로 쓰이는 Drone을 감시, 관리 등의 방범용, 순찰용 등 다양한 사회적 분야로 활용 가능. - 실외 재해 현장에서만 활용하던 소형 Drone을 화재 건물과 같은 실내 현장에도 투입
- 최종적으로는 지속적인 감시를 통하여 위험 요소를 사전에 파악하여 선제적인 대응

## 프로젝트 추진 과정에서의 문제점 및 해결방안 

### 1. 프로젝트 관리 측면 
#### 1) COVID-19 이슈
코로나 문제로 인하여 모임은 여러 번 가질 수 없었고, 줌과 팀즈를 이용하여 회의를
진행하였지만 화면 공유만으로는 Rasberry Pi나 Drone 등 하드웨어 부품의 자세한 공유가
진행되지 않아 불편함이 있었다. 

**해결방안**: 오프라인 모임이 부족했기 때문에, 한 번 모일 때 할 일들을 사전에 꼼꼼히 정리하여
문제해결에 효율성을 늘리기 위해 노력하였다.

#### 2) 주제에 대한 기초지식 부족
AI Drone 분야는 팀원 모두에게 생소한 분야였기 때문에, 프로젝트 시작부터 문제해결까지
대부분의 과정에서 생기는 이슈들을 해결하기 어려웠다. 

**해결방안**: 모르는 부분은 최대한 구글링과 멘토님의 조언을 통해 해결하려고 노력하였다. 그럼에도 해결되지 않은 부분은 팀원들의 다양한 의견을 수렴하여 여러 방면으로 시도하여 성공하는 방법을 택하였다. 결론적으로 팀원 모두 생소한 분야였지만, 프로젝트가 진행 될수록 각자의 위치에서 공부가 많이 되었고, 문제 해결에 능숙하게 되었다.

### 2. 작품 개발 측면 

#### 1) 조난자 수색을 어떻게 할 것인지에 대해 의견 충돌의 문제점이 있었다. 

**해결방안**: 팀원들의 의견을 종합하고 멘토님의 조언을 바탕으로, 가장 현실적으로 개발이 가능한 방법을 택하였다.

#### 2) 개발을 진행하는 중에 보유한 장비의 성능에 한계가 있어서 기존의 계획을 다소 수정하게되었고, 개발방향과 개발 우선순위의 변경으로 인해 프로젝트 진행이 지체되었다. 

**해결방안**: 대안 방안을 찾으려고 노력하였고 그때마다 온·오프라인 회의를 통해 해결하였다.

#### 3) H/W 개발에 필요한 부품이 누락되어, 오프라인 미팅 시간에 제대로 된 개발이 진행되지 못하는 경우가 발생했다. 

**해결방안**: 필요한 부품 구매를 인터넷 배송으로 신청하였고, 지체되는 시간을 프로젝트 진행의
중간 점검 시간으로 활용하였다. 또한 이런 일이 일어나지 않도록 다음 오프라인 모임을 가지기
전에 미리 필요한 것들을 확인하게 되었다. 

## 프로젝트를 통해 배우거나 느낀 점 
- 프로젝트 일정관리의 중요성을 깨닫고, 더욱 체계적인 계획을 세울 수 있게 되었다. 
- 팀원 모두의 일정을 맞추기 어렵기 때문에, 정해진 요일을 정기적으로 잡아서 프로젝트에 전념할 수 있도록 하는 것이 효율적이라는 것을 깨달았다. 
- Git과 Notion 등과 같은 협업 도구 다루는 법을 새롭게 배웠다. 
- 프로젝트 진행을 통해 기획, 설계, 구현, 테스트에 이르는 전반적인 과정을 학습했다. 
- Drone의 구동원리를 이해하고 활용할 수 있게 되었다. 
- 인공지능 YOLO 알고리즘을 활용하면서 인공지능 분야의 현주소를 체감하고, 더 많은 관심을 가지게 되었다. 
- 서버 구현과 기기와 서버 간 통신기능을 학습했다. 
- 프로젝트 진행 중 발생하는 문제, 체크해야 할 이슈 및 리스크를 관리하고 해결해나가는 과정을 배웠다. 
- 팀원 간의 의견을 조율하면서 팀워크를 새롭게 다졌다.


[한이음 최종보고서_AI 드론을 이용한 산불감지 및 조난자 위치 수색.pdf](https://github.com/110w110/2020_Hanium/files/6969775/_AI.pdf)

## 수상 실적
<div align="center">
<img width="396" alt="image" src="https://user-images.githubusercontent.com/87888411/181165021-b2318658-c017-4443-884c-e606746accad.png">
</div>
